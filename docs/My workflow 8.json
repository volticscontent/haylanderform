{
  "name": "My workflow 8",
  "nodes": [
    {
      "parameters": {
        "promptType": "define",
        "text": "={{ $('Edit Fields4').item.json.prompt }} \n\nImportante: Essas informações não são exemplos, os valores são de fato as informações desse cliente já que você não possui a ferramenta de acesso ao banco de dados. É normal elas estarem vazias já que você vai coletar elas usando a ferramenta do enviar_formulario.\n\nInformações Reais Atualizadas vindas do fluxo pós formulário: \n      nome = {{ $json.nome_completo }}\n      email = {{ $json.email }}\n      telefone = {{ $json.telefone }}\n      cnpj = {{ $json.cnpj }}\n      possui_sócio (boolean) = {{ $json['possui_sócio'] }}\n      observacoes (text) = {{ $json.observacoes }}\n      situacao (character varying) = {{ $json.situacao }}\n      envio_disparo (character varying) = {{ $json.envio_disparo }}\n      valor_divida_ativa (character varying) = {{ $json.valor_divida_ativa }}\n      valor_divida_municipal (character varying) = {{ $json.valor_divida_municipal }}\n      valor_divida_estadual (character varying) = {{ $json.valor_divida_estadual }}\n      valor_divida_federal (character varying) = {{ $json.valor_divida_federal }}\n      cartão-cnpj (character varying) = {{ $json['cartão-cnpj'] }}\n      tipo_divida (character varying) = {{ $json.tipo_divida }}\n      tipo_negócio (character varying) = {{ $json['tipo_negócio'] }}\n      faturamento_mensal (character varying) = {{ $json.faturamento_mensal }}\n      teria_interesse? (character varying) = {{ $json['teria_interesse?'] }}\n      razao_social (character varying) = {{ $json.razao_social }}\n      calculo_parcelamento (character varying) = {{ $json.calculo_parcelamento }}",
        "options": {
          "systemMessage": "=# Identidade e Propósito\n\nVocê é o Apolo. Você é o LeadQualifyer/SDR da Haylander Contabilidade que recebe o volume de leads e faz a qualificação deles. \n\n**SUA MISSÃO:**\nProporcionar uma experiência de qualificação personalizada para cada cliente, garantindo que ele se sinta valorizado e apoiado em sua jornada de sucesso.\n\n**O QUE VOCÊ PRECISA SABER (Sua Base de Operação):**\nVocê cumprimenta o cliente, pergunta o que ele precisa, envia o formulário. Essa é sua única interação com o cliente.\n\nQuando receber as informações do formulário, você deve analisá-las e verificar se o cliente está qualificado para a regularização ou abertura de MEI e registrar isso na tabela sem falar com o usuário. Somente afirme que o registro foi concluído. \n\n# Ferramentas Disponíveis\n\n0. **conferencia_de_registro**\nNão é em si uma tool convencional mas o fluxo envia para você sempre as informações atualizadas do cliente no banco de dados, essas informações ficam no userPrompt como valores depois de \"=\": \n\n\n1. **enviar_lista_enumerada**\n   - **Uso:** -> também não é uma tool e sim o comportamento, envie uma lista enumerada:\n   - **Gatilho:** [Trigger_1].\n   - **Opções** A lista enumerada é composta por 5 opções:\n     1. Regularização\n     2. Abertura de MEI\n     3. Falar com atendente\n     4. Informações sobre os serviços\n     5. Sair do atendimento\n\n2. **enviar_formulario**\n   - **Uso:** Enviar o formulário de qualificação para o cliente.\n   - **Gatilho:** [Trigger_2].\n   - **Perguntas:**\n     1. `Nome`\n     2. `Telefone`\n     3. `Cnpj`\n     4. `Qual é o tipo de negócio? (Mei, Simples-Nacional, etc.)`\n     5. `Você possui dívida? (Sim/Não)`\n      51. `Se sim, qual é o tipo de dívida? (Não Ajuizada \"A dívida foi inscrita, mas a cobrança judicial ainda não começou.\", Ajuizada \"Quando o órgão responsável (PGFN, Procuradoria Estadual ou Municipal) inicia um processo judicial (execução fiscal) para cobrar o débito.\", Tributária, Não tributária, )`\n      52. `Ela é: (Municipal, Estadual, Federal)`\n      53. `Qual é o valor da dívida?`\n      54. `Há quanto tempo você tem essa dívida?`\n     6. `Qual seu faturamento mensal? (Abaixo de R$10.000, R$ 10.000 - R$ 50.000, R$ 50.000 - R$ 100.000, R$ 100.000 - Acima de R$ 100.000)`\n     7. `Você possui sócios? (Sim/Não)`\n     8. `Você teria interesse em ajuda profissional para resolver? (Sim/Não)`\n\n\n3. **envio_vd / apresentacao_comercial**\n   - **Uso:** Enviar a apresentação comercial padrão.\n   - **Gatilho:** [Trigger_3]. \n\n4. **update_User1**\n   - **Uso:**  Após ler e analisar os dados do formulário preenchido pelo cliente.\n   - **CRITÉRIO DE SUCESSO (Argumentos Obrigatórios):**`\n     - `situação`: Sempre **\"qualificado\"** OU **\"desqualificado\"**.\n     - `qualificação`: Sua análise final (ICP, MQL ou SQL).\n   - **Quando usar:** SOMENTE quando tiver coletado **todos** os itens acima. Não invente dados. Essa é a consumação do seu trabalho revise sua conversa antes de registrar.\n\n5. **chamar_atendente**\n   - **Uso:** Chamar o atendente para o cliente.\n   - **Gatilho:** [Trigger_4].\n\n# Comportamento\n\n### 1. Conexão\nApresente-se de forma profissional e amigável.\n\nExemplo: \"Olá, seja bem-vindo {{$json.nome_completo}}! Me chamo Apolo, sou seu guia nesses primeiros passos e assistente 24 horas.\\n\nPara começarmos preciso saber qual o motivo da sua visita.\" \n         Acione a tool `enviar_lista_enumerada` para apresentar as opções.\n\nJAMAIS ENVIE AS PERGUNTAS VOCÊ MESMO\n\n### 2. Passividade\nVocê vai passivamente obedecer ao comando do cliente, não se preocupe em fazer perguntas, apenas execute a opção escolhida de `enviar_lista_enumerada`.\n     1. Regularização - enviar_formulario [Trigger_2]\n     2. Abertura de MEI - enviar_formulario [Trigger_2]\n     3. Falar com atendente - [Trigger_4]\n     4. Informações sobre os serviços - envio_vd / apresentacao_comercial [Trigger_3] + [Trigger_2]\n     5. Sair do atendimento - Se o cliente escolher a opção \"Sair do atendimento\" você deve encerrar a conversa com uma mensagem de agradecimento e encerrar a sessão.\n\n### 3. Análise Assíncrona \nApós receber as informações do formulário de qualificação, você deve analisar as informações e verificar se o cliente está qualificado para a regularização ou abertura de MEI. Se faltar coisas importantes para sua análise, você pode perguntar ao cliente diretamente. Se aparentar não saber não pergunte mais e use a tool `update_user` com a situação \"desqualificado\" e a qualificação \"MQL\".\n"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 1.7,
      "position": [
        -784,
        176
      ],
      "id": "ee87cd13-dcec-4b9c-99e9-e9e8745efc72",
      "name": "AI Agent"
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "gpt-4o-mini",
          "mode": "list",
          "cachedResultName": "gpt-4o-mini"
        },
        "options": {
          "temperature": 1
        }
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        -304,
        -144
      ],
      "id": "75444be4-fe90-4f9e-bf25-742f162d8612",
      "name": "cerebro",
      "credentials": {
        "openAiApi": {
          "id": "K71STqgnCBSVU7AY",
          "name": "Cachorro ofertas api 2"
        }
      }
    },
    {
      "parameters": {
        "description": "=Ferramenta: envio_vd/apresentacao_comercial\n\nDescrição\nEnvia materiais auxiliares ao cliente:\n\ntipo = \"apc\" → dispara a apresentação comercial com resumo das opções e preços.\n\ntipo = \"video\" → dispara vídeo tutorial de como cadastrar procuração no e-CAC.\n\n⚠️ NUNCA envie sem esse padrão.\n\nInput (modelo obrigatório)\n\n{\n  \"action\": \"video\" || \"apc\",\n  \"telefone\": \"{{ $('Edit Fields4').item.json.user.number }}\"\n}",
        "workflowId": {
          "__rl": true,
          "value": "yi8czdl4WEnL3YDY",
          "mode": "list",
          "cachedResultUrl": "/workflow/yi8czdl4WEnL3YDY",
          "cachedResultName": "cliente_management"
        },
        "workflowInputs": {
          "mappingMode": "defineBelow",
          "value": {
            "action": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('action', ``, 'string') }}",
            "telefone": "={{ $json.user.number }}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "action",
              "displayName": "action",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string",
              "removed": false
            },
            {
              "id": "nome_completo",
              "displayName": "nome_completo",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string",
              "removed": true
            },
            {
              "id": "telefone",
              "displayName": "telefone",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string",
              "removed": false
            },
            {
              "id": "cnpj",
              "displayName": "cnpj",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string",
              "removed": true
            },
            {
              "id": "observações",
              "displayName": "observações",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string",
              "removed": true
            },
            {
              "id": "situação",
              "displayName": "situação",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string",
              "removed": true
            },
            {
              "id": "qualificação",
              "displayName": "qualificação",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string",
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        }
      },
      "type": "@n8n/n8n-nodes-langchain.toolWorkflow",
      "typeVersion": 2.2,
      "position": [
        -336,
        1344
      ],
      "id": "1e423c85-4f5e-4753-bcb9-e7178675b7c9",
      "name": "envio_vd/apresentacao_comercial"
    },
    {
      "parameters": {
        "description": "=Ferramenta: contact_24h\n\nDescrição\nAgenda contato de follow-up em 24 horas para o cliente.\nUtilizada para garantir acompanhamento adequado após atendimento inicial.\n\n⚠️ Sempre exige telefone do cliente para identificação.\n⚠️ Agenda automaticamente contato para 24h após execução.\n⚠️ Registra no sistema de controle de contatos.\n\nInput obrigatório:\n{\n  \"action\": \"contact_24h\",\n  \"telefone\": \"{{$json.user.number}}\",\n  \"tipo_contato\": \"followup\",\n  \"canal\": \"whatsapp\"\n}\n\nOutput: Confirmação do agendamento com ID do contato",
        "workflowId": {
          "__rl": true,
          "value": "yi8czdl4WEnL3YDY",
          "mode": "list",
          "cachedResultUrl": "/workflow/yi8czdl4WEnL3YDY",
          "cachedResultName": "cliente_management"
        },
        "workflowInputs": {
          "mappingMode": "defineBelow",
          "value": {
            "action": "contact_24h",
            "telefone": "={{$json.user.number}}",
            "nome_completo": "={{ $json.user.name }}",
            "cnpj": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('cnpj', ``, 'string') }}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "action",
              "displayName": "action",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string"
            },
            {
              "id": "nome_completo",
              "displayName": "nome_completo",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string",
              "removed": false
            },
            {
              "id": "telefone",
              "displayName": "telefone",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string"
            },
            {
              "id": "cnpj",
              "displayName": "cnpj",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string",
              "removed": false
            },
            {
              "id": "observações",
              "displayName": "observações",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string",
              "removed": true
            },
            {
              "id": "situação",
              "displayName": "situação",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string",
              "removed": true
            },
            {
              "id": "qualificação",
              "displayName": "qualificação",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string",
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        }
      },
      "type": "@n8n/n8n-nodes-langchain.toolWorkflow",
      "typeVersion": 2.2,
      "position": [
        -304,
        528
      ],
      "id": "16bb2369-c366-4632-a2b7-5ade9b1b7584",
      "name": "contact_24h"
    },
    {
      "parameters": {
        "sessionIdType": "customKey",
        "sessionKey": "={{ $('Edit Fields4').item.json.user.number }}",
        "sessionTTL": 600,
        "contextWindowLength": 1
      },
      "type": "@n8n/n8n-nodes-langchain.memoryRedisChat",
      "typeVersion": 1.4,
      "position": [
        -176,
        -144
      ],
      "id": "dd2c8819-55c9-41ed-8b6d-3f17f083fc5a",
      "name": "Redis Chat Memory",
      "credentials": {
        "redis": {
          "id": "wwjOvFZpBExq9jgc",
          "name": "Redis_chat_memory"
        }
      }
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "={{ $json.prompt }}\n\nImportante: Essas informações não são exemplos, os valores são de fato as informações desse cliente já que você não possui a ferramenta de acesso ao banco de dados. É normal elas estarem vazias já que você vai coletar elas usando a ferramenta do enviar_formulario.\n\nInformações Reais Atualizadas vindas do fluxo pós formulário: \n      possui_sócio (boolean) = {{ $json['possui_sócio'] }}\n      observacoes (text) = {{ $json.observacoes }}\n      situacao (character varying) = {{ $json.situacao }}\n      envio_disparo (character varying) = {{ $json.envio_disparo }}\n      valor_divida_ativa (character varying) = {{ $json.valor_divida_ativa }}\n      valor_divida_municipal (character varying) = {{ $json.valor_divida_municipal }}\n      valor_divida_estadual (character varying) = {{ $json.valor_divida_estadual }}\n      valor_divida_federal (character varying) = {{ $json.valor_divida_federal }}\n      cartão-cnpj (character varying) = {{ $json['cartão-cnpj'] }}\n      tipo_divida (character varying) = {{ $json.tipo_divida }}\n      tipo_negócio (character varying) = {{ $json['tipo_negócio'] }}\n      faturamento_mensal (character varying) = {{ $json.faturamento_mensal }}\n      teria_interesse? (character varying) = {{ $json['teria_interesse?'] }}\n      razao_social (character varying) = {{ $json.razao_social }}\n      calculo_parcelamento (character varying) = {{ $json.calculo_parcelamento }}",
        "options": {
          "systemMessage": "=A partir de agora, o Apolo deve seguir sempre este procedimento quando detectar que precisa confirmar dados do cliente antes de qualquer consulta ou explicação de serviços.\n\n1) Solicitação do Formulário (obrigatória)\n\nQuando faltar qualquer dado essencial (nome real, telefone validado, CPF ou motivo da procura), o Apolo deve:\n\nAfirmar claramente que é necessário enviar um formulário rápido\ne que o cliente precisa confirmar:\n\nNome completo\n\nTelefone\n\nCPF\n\nMotivo da procura\n\nO tom deve ser simples e direto:\n“Preciso te enviar um formulário rápido para confirmar seus dados e já adiantar sua análise.”\n\n2) Confirmar se o cliente quer ser cadastrado\n\nAntes de enviar o formulário, Apolo deve perguntar:\n\n“Você confirma que deseja ser cadastrado no nosso sistema para seguirmos com o atendimento?”\n\nO cadastro só é iniciado com um Sim explícito.\n\n3) Perguntar sobre o cadastro no e-CAC\n\nApós a confirmação do cadastro, Apolo deve perguntar:\n\n“Aproveitando, você também quer que eu já faça o pedido para criar seu acesso ao e-CAC? Isso agiliza muito sua regularização.”\n\nSe a pessoa disser Sim, Apolo registra a intenção e segue para o fluxo preparado para isso.\nSe disser Não, o fluxo segue normalmente.\n\n4) Template final da nova interação\n\nO Apolo deve usar a abordagem em 2 ou 3 linhas, assim:\n\nMensagem padrão do Apolo:\n\n“Para seguir, preciso te enviar um formulário rápido para confirmar seu nome, telefone, CPF e o motivo da sua procura.\nVocê confirma que deseja ser cadastrado no nosso sistema?\nQuer aproveitar e pedir também o cadastro no e-CAC de uma vez?”\n\n5) Como integrar isso ao fluxo principal\n\nEste bloco deve ficar antes do uso das ferramentas e antes de qualquer análise.\n\nA lógica é:\n\nVerificar se falta nome/telefone/CPF/motivo.\n\nSe faltar → obrigatoriamente acionar essa etapa.\n\nPedir confirmação para cadastro.\n\nPerguntar sobre o e-CAC.\n\nSe “Sim”, disparar o formulário.\n\nSó depois disso continuar o fluxo normal.",
          "maxIterations": 5,
          "returnIntermediateSteps": true
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 1.7,
      "position": [
        144,
        192
      ],
      "id": "89552dba-b278-4cf6-b8f3-ae87eeb9f9c5",
      "name": "AI Agent1"
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "leftValue": "={{ $json.situacao }}",
                    "rightValue": "=cliente",
                    "operator": {
                      "type": "string",
                      "operation": "notEquals"
                    },
                    "id": "e8f562f8-4e81-4c3a-8d14-3402503e8468"
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "d07f1fcf-31e1-477a-b952-ec4be519b18b",
                    "leftValue": "={{ $json.situacao }}",
                    "rightValue": "cliente",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.3,
      "position": [
        -1264,
        208
      ],
      "id": "5586fe36-9d71-43e2-9a78-02506f12f644",
      "name": "Switch1"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "={{ $('Edit Fields4').item.json.prompt }}\n\nImportante: Essas informações não são exemplos, os valores são de fato as informações desse cliente já que você não possui a ferramenta de acesso ao banco de dados. É normal elas estarem vazias já que você vai coletar elas usando a ferramenta do enviar_formulario.\n\nInformações Reais Atualizadas vindas do fluxo pós formulário: \n      nome = {{ $json.nome_completo }}\n      email = {{ $json.email }}\n      telefone = {{ $json.telefone }}\n      cnpj = {{ $json.cnpj }}\n      possui_sócio (boolean) = {{ $json['possui_sócio'] }}\n      observacoes (text) = {{ $json.observacoes }}\n      situacao (character varying) = {{ $json.situacao }}\n      envio_disparo (character varying) = {{ $json.envio_disparo }}\n      valor_divida_ativa (character varying) = {{ $json.valor_divida_ativa }}\n      valor_divida_municipal (character varying) = {{ $json.valor_divida_municipal }}\n      valor_divida_estadual (character varying) = {{ $json.valor_divida_estadual }}\n      valor_divida_federal (character varying) = {{ $json.valor_divida_federal }}\n      cartão-cnpj (character varying) = {{ $json['cartão-cnpj'] }}\n      tipo_divida (character varying) = {{ $json.tipo_divida }}\n      tipo_negócio (character varying) = {{ $json['tipo_negócio'] }}\n      faturamento_mensal (character varying) = {{ $json.faturamento_mensal }}\n      teria_interesse? (character varying) = {{ $json['teria_interesse?'] }}\n      razao_social (character varying) = {{ $json.razao_social }}\n      calculo_parcelamento (character varying) = {{ $json.calculo_parcelamento }}",
        "options": {
          "systemMessage": "=# Identidade e Propósito\n\nVocê é o Icaro. Você é o Consultor Comercial da Haylander Contabilidade. Você recebe os leads já qualificados pelo Apolo (SDR).\n\nVocê é direto ao ponto, tente não falar demais. \n\n**SUA MISSÃO:**\nTransformar leads qualificados (Dívidas, Alto Faturamento, Necessidade Clara de Regularização) em novos clientes. Esses leads podem ser de 3 tipos. MQL, SQL e ICP.\n\n**O QUE VOCÊ PRECISA SABER (Sua Base de Operação):**\nVocê entra em cena quando o lead já demonstrou interesse e potencial (possui dívidas, alto faturamento ou necessidade clara de regularização). Você já tem acesso aos dados coletados no formulário.\n\n# Ferramentas Disponíveis\n\n0. **conferencia_de_registro**\nNão é em si uma tool convencional mas o fluxo envia para você sempre as informações atualizadas do cliente no banco de dados, essas informações ficam abaixo como valores depois de \"=\": \n\nImportante: Essas informações não são exemplos, os valores são de fato as informações desse cliente já que você não possui a ferramenta de acesso ao banco de dados.\n\n1. **agendar_reuniao**\n   - **Uso:** Enviar link do calendário para agendamento de reunião de diagnóstico ou fechamento.\n   - **Gatilho:** Quando o cliente demonstra interesse mas precisa de uma conversa mais detalhada.\n\n2. **chamar_atendente**\n   - **Uso:** Chamar o atendente humano.\n   - **Gatilho:** Quando o cliente demonstra interesse no serviço e precisa de uma conversa mais detalhada ou precisa de ajuda com algum problema que você não pode resolver como gerar um contrato, ou q\n\n3. **update_user**\n   - **Uso:** Enviar o link para assinatura do contrato.\n   - **Gatilho:** Quando o cliente aceita a proposta verbalmente.\n\n4. **services**\n   - **Uso:** Consultar base de serviços disponíveis.\n   - **Gatilho:** Quando o cliente solicita informações sobre os serviços oferecidos, quando você quiser oferecer um serviço para o cliente.\n\n# Comportamento\n\n### 1. Abordagem Consultiva\nDiferente do Apolo, você não é passivo. Você deve conduzir a venda. Mostre que você entende a dor do cliente (ex: medo de execução fiscal, travamento de conta bancária) e que a Haylander tem a solução específica.\n\n### 2. Uso de Dados\nSempre cite os dados que o cliente forneceu para criar rapport.\nExemplo: \"Vi aqui que você tem uma dívida Federal. Nós temos um especialista em parcelamento desse tipo de débito...\"\n\n### 3. Fechamento\nSempre busque o próximo passo (Call To Action). Não deixe a conversa morrer.\n- \"Podemos agendar uma rápida chamada para eu te explicar como reduzir essa dívida?\"\n- \"Posso te enviar a proposta para regularizar seu CNPJ ainda hoje?\"",
          "maxIterations": 5,
          "returnIntermediateSteps": true
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 1.7,
      "position": [
        -304,
        176
      ],
      "id": "465451f5-c505-4508-a2c7-73ce34cd1eb1",
      "name": "AI Agent2"
    },
    {
      "parameters": {
        "options": {
          "dimensions": 1536,
          "batchSize": 600
        }
      },
      "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
      "typeVersion": 1.2,
      "position": [
        -464,
        480
      ],
      "id": "1168ed1d-f610-4fbc-a421-bce699263907",
      "name": "Embeddings OpenAI",
      "credentials": {
        "openAiApi": {
          "id": "VsDBRcFEnBc2PY6o",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "mode": "retrieve-as-tool",
        "toolName": "servicos_contabeis",
        "toolDescription": "Responde perguntas sobre parcelamento de dívidas, MEI, envio de declarações e informações fiscais com base em documentos salvos. Sempre formate para remover. Os valores dos serviços também estão na planilha.",
        "topK": 50,
        "options": {
          "distanceStrategy": "cosine"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.vectorStorePGVector",
      "typeVersion": 1.2,
      "position": [
        -560,
        336
      ],
      "id": "7f97fb21-1455-469e-870f-d8084f47ff24",
      "name": "services",
      "credentials": {
        "postgres": {
          "id": "NKGFQ42zDAIGcasd",
          "name": "Postgres account"
        }
      }
    },
    {
      "parameters": {},
      "type": "@n8n/n8n-nodes-langchain.toolThink",
      "typeVersion": 1.1,
      "position": [
        -304,
        368
      ],
      "id": "10b0e3a6-4033-4c9a-b9c6-b6decaafec48",
      "name": "Think"
    },
    {
      "parameters": {
        "description": "=Chame o atendente humano. SEMPRE Envie - \" {{ $json.user.number }} {{ $json.user.name }} \" - \"Aguardando Link Pagamento || Aguardando ajuda para consulta || 'Situação'\"",
        "workflowId": {
          "__rl": true,
          "value": "PtJpwHQGZLeDSSNO",
          "mode": "list",
          "cachedResultUrl": "/workflow/PtJpwHQGZLeDSSNO",
          "cachedResultName": "chamar_atendente"
        },
        "workflowInputs": {
          "mappingMode": "defineBelow",
          "value": {},
          "matchingColumns": [],
          "schema": [],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        }
      },
      "type": "@n8n/n8n-nodes-langchain.toolWorkflow",
      "typeVersion": 2.2,
      "position": [
        -32,
        1344
      ],
      "id": "4fb81112-6ee4-4a23-9708-0e08c73dab14",
      "name": "chamar_atendente"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "5d89e33d-6f15-442c-95a0-ca3f3312afe0",
              "leftValue": "={{ $json.data_cadastro }}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "exists",
                "singleValue": true
              }
            },
            {
              "id": "aed58fd5-5ae0-49c3-abc7-bb64fb782af1",
              "leftValue": "={{ $json.data_cadastro }}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "notEmpty",
                "singleValue": true
              }
            }
          ],
          "combinator": "or"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        -1600,
        224
      ],
      "id": "2578b282-da6b-4633-b1e8-4ddd320e8cee",
      "name": "If6"
    },
    {
      "parameters": {
        "schema": {
          "__rl": true,
          "mode": "list",
          "value": "public"
        },
        "table": {
          "__rl": true,
          "value": "haylander",
          "mode": "list",
          "cachedResultName": "haylander"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "cnpj": "null",
            "nome_completo": "={{ $('Edit Fields4').item.json.user.name }}",
            "data_cadastro": "={{ $now }}",
            "telefone": "={{ $('Edit Fields4').item.json.user.number }}",
            "atualizado_em": "={{ $now }}",
            "situacao": "aguardando_qualificação"
          },
          "matchingColumns": [
            "id"
          ],
          "schema": [
            {
              "id": "id",
              "displayName": "id",
              "required": false,
              "defaultMatch": true,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "cnpj",
              "displayName": "cnpj",
              "required": true,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "razao_social",
              "displayName": "razao_social",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "nome_completo",
              "displayName": "nome_completo",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "data_cadastro",
              "displayName": "data_cadastro",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "dateTime",
              "canBeUsedToMatch": true
            },
            {
              "id": "data_controle_24h",
              "displayName": "data_controle_24h",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "dateTime",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "telefone",
              "displayName": "telefone",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "email",
              "displayName": "email",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "observacoes",
              "displayName": "observacoes",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "atualizado_em",
              "displayName": "atualizado_em",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "dateTime",
              "canBeUsedToMatch": true
            },
            {
              "id": "situacao",
              "displayName": "situacao",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "envio_disparo",
              "displayName": "envio_disparo",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "valor_divida_ativa",
              "displayName": "valor_divida_ativa",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "valor_divida_municipal",
              "displayName": "valor_divida_municipal",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "valor_divida_estadual",
              "displayName": "valor_divida_estadual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "valor_divida_federal",
              "displayName": "valor_divida_federal",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "cartão-cnpj",
              "displayName": "cartão-cnpj",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "qualificação",
              "displayName": "qualificação",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "tipo_divida",
              "displayName": "tipo_divida",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "tipo_negócio",
              "displayName": "tipo_negócio",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "faturamento_mensal",
              "displayName": "faturamento_mensal",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "possui_sócio",
              "displayName": "possui_sócio",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "boolean",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "teria_interesse?",
              "displayName": "teria_interesse?",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.6,
      "position": [
        -1440,
        336
      ],
      "id": "24816b26-5ecf-40ce-aad5-6274a456c1bc",
      "name": "Cadastro",
      "credentials": {
        "postgres": {
          "id": "ItHwr54zRbRRCsOg",
          "name": "Postgres account 2"
        }
      }
    },
    {
      "parameters": {
        "operation": "select",
        "schema": {
          "__rl": true,
          "mode": "list",
          "value": "public"
        },
        "table": {
          "__rl": true,
          "value": "haylander",
          "mode": "list",
          "cachedResultName": "haylander"
        },
        "returnAll": true,
        "where": {
          "values": [
            {
              "column": "telefone",
              "value": "={{ $json.user.number }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.6,
      "position": [
        -1744,
        224
      ],
      "id": "b1a7acfe-6edf-42be-88fd-54cbe664dd18",
      "name": "Get User",
      "alwaysOutputData": true,
      "credentials": {
        "postgres": {
          "id": "ItHwr54zRbRRCsOg",
          "name": "Postgres account 2"
        }
      }
    },
    {
      "parameters": {
        "description": "=Ferramenta: enviar_formulario\n\nDescrição\nEnvia uma mensagem no mesmo chat configurada para coletar a intenção do cliente\n\n### Exemplos Práticos de como enviar observações:\n1. Opção Simples (sem espaços):\n   \n   - Regularizacao\n\n2. Com Espaços (URL Encoded):\n   \n   - O ideal é substituir os espaços por %20 .\n   - Abertura%20de%20MEI\n   - Resultado no Banco: Abertura de MEI\n\n3. Com Acentuação:\n   \n   - Os navegadores e o sistema tratam automaticamente, mas em integrações (como disparadores de WhatsApp ou e-mail), é seguro usar o formato codificado.\n   - Falar%20com%20atendente\n\nResumindo\n\nOu você envia só    \n   - Regularizacao\nOu se precisar de espaço\n   - Falar%20com%20atendente\n\nVocê nunca deve enviar\n   - Cliente escolheu Regularização\n   - Optou por falar com atendente\n   - Cliente%escolheu%Regularização\n   - Qualquer outra coisa que fuja do modelo permitido",
        "workflowId": {
          "__rl": true,
          "value": "yi8czdl4WEnL3YDY",
          "mode": "list",
          "cachedResultUrl": "/workflow/yi8czdl4WEnL3YDY",
          "cachedResultName": "cliente_management"
        },
        "workflowInputs": {
          "mappingMode": "defineBelow",
          "value": {
            "action": "=form",
            "telefone": "={{ $('Edit Fields4').item.json.user.number }}",
            "observações": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('observa__es', `     Regularização\n     Abertura de MEI\n     Falar com atendente\n     Informações sobre os serviços\n     Sair do atendimento`, 'string') }}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "action",
              "displayName": "action",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string",
              "removed": false
            },
            {
              "id": "nome_completo",
              "displayName": "nome_completo",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string",
              "removed": true
            },
            {
              "id": "telefone",
              "displayName": "telefone",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string",
              "removed": false
            },
            {
              "id": "cnpj",
              "displayName": "cnpj",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string",
              "removed": true
            },
            {
              "id": "observações",
              "displayName": "observações",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string",
              "removed": false
            },
            {
              "id": "situação",
              "displayName": "situação",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string",
              "removed": true
            },
            {
              "id": "qualificação",
              "displayName": "qualificação",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string",
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        }
      },
      "type": "@n8n/n8n-nodes-langchain.toolWorkflow",
      "typeVersion": 2.2,
      "position": [
        -912,
        416
      ],
      "id": "009e8803-39ea-4d54-9d67-3da1785ad42d",
      "name": "enviar_formulario"
    },
    {
      "parameters": {
        "description": "=Ferramenta: update_User\n\nDescrição\nAtualiza dados de um cliente existente no sistema.\nPode atualizar nome, telefone, CNPJ e outros campos.\nSe fornecido um CNPJ, pode consultar dados do SERPRO para atualização automática.\n\n⚠️ Sempre exige o telefone para identificar o cliente.\n⚠️ Outros campos são opcionais para atualização.\n\nInput (modelo obrigatório)\n\n{\n  \"action\": \"update_user\",\n  \"telefone\": \"{{ $('Edit Fields4').item.json.user.number }}\",\n  \"situação\": \"escolha da lista [1 a 5]\",\n  \"qualificação\": \"qualificado/desqualificado\",\n}",
        "workflowId": {
          "__rl": true,
          "value": "yi8czdl4WEnL3YDY",
          "mode": "list",
          "cachedResultUrl": "/workflow/yi8czdl4WEnL3YDY",
          "cachedResultName": "cliente_management"
        },
        "workflowInputs": {
          "mappingMode": "defineBelow",
          "value": {
            "telefone": "={{ $('Edit Fields4').item.json.user.number }}",
            "situação": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('situa__o', `Pré-qualificado / Desqualificado`, 'string') }}",
            "action": "reuniao"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "action",
              "displayName": "action",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string"
            },
            {
              "id": "nome_completo",
              "displayName": "nome_completo",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string",
              "removed": true
            },
            {
              "id": "telefone",
              "displayName": "telefone",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string"
            },
            {
              "id": "cnpj",
              "displayName": "cnpj",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string",
              "removed": true
            },
            {
              "id": "observações",
              "displayName": "observações",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string",
              "removed": true
            },
            {
              "id": "situação",
              "displayName": "situação",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string",
              "removed": false
            },
            {
              "id": "qualificação",
              "displayName": "qualificação",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string",
              "removed": true
            },
            {
              "id": "motivo_qualificação",
              "displayName": "motivo_qualificação",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string",
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        }
      },
      "type": "@n8n/n8n-nodes-langchain.toolWorkflow",
      "typeVersion": 2.2,
      "position": [
        -48,
        528
      ],
      "id": "f5b514e4-1db0-4457-ba7c-48a48e482074",
      "name": "agendar_reuniao"
    },
    {
      "parameters": {
        "description": "=Ferramenta: update_User\n\nDescrição\nAtualiza dados de um cliente existente no sistema.\nPode atualizar nome, telefone, CNPJ e outros campos.\nSe fornecido um CNPJ, pode consultar dados do SERPRO para atualização automática.\n\n⚠️ Sempre exige o telefone para identificar o cliente.\n⚠️ Outros campos são opcionais para atualização.\n\nInput (modelo obrigatório)\n\n{\n  \"action\": \"update_user\",\n  \"telefone\": \"{{ $('Edit Fields4').item.json.user.number }}\",\n  \"situação\": \"escolha da lista [1 a 5]\",\n  \"qualificação\": \"qualificado/desqualificado\",\n}",
        "workflowId": {
          "__rl": true,
          "value": "yi8czdl4WEnL3YDY",
          "mode": "list",
          "cachedResultUrl": "/workflow/yi8czdl4WEnL3YDY",
          "cachedResultName": "cliente_management"
        },
        "workflowInputs": {
          "mappingMode": "defineBelow",
          "value": {
            "action": "update_user",
            "telefone": "={{ $('Edit Fields4').item.json.user.number }}",
            "situação": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('situa__o', `Pré-qualificado / Desqualificado`, 'string') }}",
            "qualificação": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('qualifica__o', `MQL / SQL / ICP`, 'string') }}",
            "motivo_qualificação": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('motivo_qualifica__o', `O motivo que te levou a qualificar ou desqualificar o cliente`, 'string') }}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "action",
              "displayName": "action",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string"
            },
            {
              "id": "nome_completo",
              "displayName": "nome_completo",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string",
              "removed": true
            },
            {
              "id": "telefone",
              "displayName": "telefone",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string"
            },
            {
              "id": "cnpj",
              "displayName": "cnpj",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string",
              "removed": true
            },
            {
              "id": "observações",
              "displayName": "observações",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string",
              "removed": true
            },
            {
              "id": "situação",
              "displayName": "situação",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string",
              "removed": false
            },
            {
              "id": "qualificação",
              "displayName": "qualificação",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string",
              "removed": false
            },
            {
              "id": "motivo_qualificação",
              "displayName": "motivo_qualificação",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string",
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        }
      },
      "type": "@n8n/n8n-nodes-langchain.toolWorkflow",
      "typeVersion": 2.2,
      "position": [
        -48,
        352
      ],
      "id": "1e88ade7-d98b-4eeb-ac24-f12c25cc9ec7",
      "name": "update_User2"
    },
    {
      "parameters": {
        "description": "=Ferramenta: update_User\n\nDescrição\nAtualiza dados de um cliente existente no sistema.\nPode atualizar nome, telefone, CNPJ e outros campos.\nSe fornecido um CNPJ, pode consultar dados do SERPRO para atualização automática.\n\n⚠️ Sempre exige o telefone para identificar o cliente.\n⚠️ Outros campos são opcionais para atualização.\n\nInput (modelo obrigatório)\n\n{\n  \"action\": \"update_user\",\n  \"telefone\": \"{{ $('Edit Fields4').item.json.user.number }}\",\n  \"situação\": \"escolha da lista [1 a 5]\",\n  \"qualificação\": \"qualificado/desqualificado\",\n}",
        "workflowId": {
          "__rl": true,
          "value": "yi8czdl4WEnL3YDY",
          "mode": "list",
          "cachedResultUrl": "/workflow/yi8czdl4WEnL3YDY",
          "cachedResultName": "cliente_management"
        },
        "workflowInputs": {
          "mappingMode": "defineBelow",
          "value": {
            "action": "update_user",
            "telefone": "={{ $('Edit Fields4').item.json.user.number }}",
            "situação": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('situa__o', `Pré-qualificado / Desqualificado`, 'string') }}",
            "qualificação": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('qualifica__o', `MQL / SQL / ICP`, 'string') }}",
            "motivo_qualificação": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('motivo_qualifica__o', `O motivo que te levou a qualificar ou desqualificar o cliente`, 'string') }}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "action",
              "displayName": "action",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string"
            },
            {
              "id": "nome_completo",
              "displayName": "nome_completo",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string",
              "removed": true
            },
            {
              "id": "telefone",
              "displayName": "telefone",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string"
            },
            {
              "id": "cnpj",
              "displayName": "cnpj",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string",
              "removed": true
            },
            {
              "id": "observações",
              "displayName": "observações",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string",
              "removed": true
            },
            {
              "id": "situação",
              "displayName": "situação",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string",
              "removed": false
            },
            {
              "id": "qualificação",
              "displayName": "qualificação",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string",
              "removed": false
            },
            {
              "id": "motivo_qualificação",
              "displayName": "motivo_qualificação",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string",
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        }
      },
      "type": "@n8n/n8n-nodes-langchain.toolWorkflow",
      "typeVersion": 2.2,
      "position": [
        -864,
        608
      ],
      "id": "284f22bb-e888-4f3b-9c6a-49ab2a9ca86c",
      "name": "update_User1"
    },
    {
      "parameters": {
        "description": "=Ferramenta: update_User\n\nDescrição\nAtualiza dados de um cliente existente no sistema.\nPode atualizar nome, telefone, CNPJ e outros campos.\nSe fornecido um CNPJ, pode consultar dados do SERPRO para atualização automática.\n\n⚠️ Sempre exige o telefone para identificar o cliente.\n⚠️ Outros campos são opcionais para atualização.\n\nInput (modelo obrigatório)\n\n{\n  \"action\": \"update_user\",\n  \"telefone\": \"{{ $('Edit Fields4').item.json.user.number }}\",\n  \"situação\": \"escolha da lista [1 a 5]\",\n  \"qualificação\": \"qualificado/desqualificado\",\n}",
        "workflowId": {
          "__rl": true,
          "value": "yi8czdl4WEnL3YDY",
          "mode": "list",
          "cachedResultUrl": "/workflow/yi8czdl4WEnL3YDY",
          "cachedResultName": "cliente_management"
        },
        "workflowInputs": {
          "mappingMode": "defineBelow",
          "value": {
            "action": "update_user",
            "telefone": "={{ $('Edit Fields4').item.json.user.number }}",
            "situação": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('situa__o', `Pré-qualificado / Desqualificado`, 'string') }}",
            "qualificação": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('qualifica__o', `MQL / SQL / ICP`, 'string') }}",
            "motivo_qualificação": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('motivo_qualifica__o', `O motivo que te levou a qualificar ou desqualificar o cliente`, 'string') }}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "action",
              "displayName": "action",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string"
            },
            {
              "id": "nome_completo",
              "displayName": "nome_completo",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string",
              "removed": true
            },
            {
              "id": "telefone",
              "displayName": "telefone",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string"
            },
            {
              "id": "cnpj",
              "displayName": "cnpj",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string",
              "removed": true
            },
            {
              "id": "observações",
              "displayName": "observações",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string",
              "removed": true
            },
            {
              "id": "situação",
              "displayName": "situação",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string",
              "removed": false
            },
            {
              "id": "qualificação",
              "displayName": "qualificação",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string",
              "removed": false
            },
            {
              "id": "motivo_qualificação",
              "displayName": "motivo_qualificação",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string",
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        }
      },
      "type": "@n8n/n8n-nodes-langchain.toolWorkflow",
      "typeVersion": 2.2,
      "position": [
        288,
        704
      ],
      "id": "15aeee05-e508-4a9b-9748-8061c19a62e5",
      "name": "update_User"
    },
    {
      "parameters": {
        "description": "=Ferramenta: update_User\n\nDescrição\nAtualiza dados de um cliente existente no sistema.\nPode atualizar nome, telefone, CNPJ e outros campos.\nSe fornecido um CNPJ, pode consultar dados do SERPRO para atualização automática.\n\n⚠️ Sempre exige o telefone para identificar o cliente.\n⚠️ Outros campos são opcionais para atualização.\n\nInput (modelo obrigatório)\n\n{\n  \"action\": \"update_user\",\n  \"telefone\": \"{{ $('Edit Fields4').item.json.user.number }}\",\n  \"situação\": \"escolha da lista [1 a 5]\",\n  \"qualificação\": \"qualificado/desqualificado\",\n}",
        "workflowId": {
          "__rl": true,
          "value": "yi8czdl4WEnL3YDY",
          "mode": "list",
          "cachedResultUrl": "/workflow/yi8czdl4WEnL3YDY",
          "cachedResultName": "cliente_management"
        },
        "workflowInputs": {
          "mappingMode": "defineBelow",
          "value": {
            "action": "get_user",
            "telefone": "={{ $('Edit Fields4').item.json.user.number || null }}",
            "cnpj": "={{ $json.cnpj || null }}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "action",
              "displayName": "action",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string"
            },
            {
              "id": "nome_completo",
              "displayName": "nome_completo",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string",
              "removed": true
            },
            {
              "id": "telefone",
              "displayName": "telefone",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string"
            },
            {
              "id": "cnpj",
              "displayName": "cnpj",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string",
              "removed": false
            },
            {
              "id": "observações",
              "displayName": "observações",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string",
              "removed": true
            },
            {
              "id": "situação",
              "displayName": "situação",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string",
              "removed": true
            },
            {
              "id": "qualificação",
              "displayName": "qualificação",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string",
              "removed": true
            },
            {
              "id": "motivo_qualificação",
              "displayName": "motivo_qualificação",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string",
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        }
      },
      "type": "@n8n/n8n-nodes-langchain.toolWorkflow",
      "typeVersion": 2.2,
      "position": [
        -176,
        1344
      ],
      "id": "b6076cd3-16dd-49d6-b7da-f255da25c61c",
      "name": "get_User"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "c98a01c6-6b86-4fce-bce0-f48a6ce48017",
              "leftValue": "={{ $json.qualificação }}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "exists",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        -1024,
        48
      ],
      "id": "ade38184-2a17-40ab-9b5a-10bfbb0bdb2b",
      "name": "If7"
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "gpt-5-chat-latest",
          "mode": "list",
          "cachedResultName": "gpt-5-chat-latest"
        },
        "options": {
          "temperature": 1
        }
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        -304,
        32
      ],
      "id": "2e23eb47-9c71-42f2-ba05-eb77a31ce2ad",
      "name": "cerebro_vendedor",
      "credentials": {
        "openAiApi": {
          "id": "K71STqgnCBSVU7AY",
          "name": "Cachorro ofertas api 2"
        }
      }
    }
  ],
  "pinData": {},
  "connections": {
    "cerebro": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent",
            "type": "ai_languageModel",
            "index": 0
          },
          {
            "node": "AI Agent1",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "envio_vd/apresentacao_comercial": {
      "ai_tool": [
        [
          {
            "node": "AI Agent",
            "type": "ai_tool",
            "index": 0
          },
          {
            "node": "AI Agent1",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "contact_24h": {
      "ai_tool": [
        [
          {
            "node": "AI Agent2",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Redis Chat Memory": {
      "ai_memory": [
        [
          {
            "node": "AI Agent",
            "type": "ai_memory",
            "index": 0
          },
          {
            "node": "AI Agent2",
            "type": "ai_memory",
            "index": 0
          },
          {
            "node": "AI Agent1",
            "type": "ai_memory",
            "index": 0
          }
        ]
      ]
    },
    "Switch1": {
      "main": [
        [
          {
            "node": "If7",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "AI Agent1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Embeddings OpenAI": {
      "ai_embedding": [
        [
          {
            "node": "services",
            "type": "ai_embedding",
            "index": 0
          }
        ]
      ]
    },
    "services": {
      "ai_tool": [
        [
          {
            "node": "AI Agent2",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Think": {
      "ai_tool": [
        [
          {
            "node": "AI Agent2",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "chamar_atendente": {
      "ai_tool": [
        [
          {
            "node": "AI Agent1",
            "type": "ai_tool",
            "index": 0
          },
          {
            "node": "AI Agent2",
            "type": "ai_tool",
            "index": 0
          },
          {
            "node": "AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "If6": {
      "main": [
        [
          {
            "node": "Switch1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Cadastro",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Cadastro": {
      "main": [
        [
          {
            "node": "Switch1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get User": {
      "main": [
        [
          {
            "node": "If6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "enviar_formulario": {
      "ai_tool": [
        [
          {
            "node": "AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "agendar_reuniao": {
      "ai_tool": [
        [
          {
            "node": "AI Agent2",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "update_User2": {
      "ai_tool": [
        [
          {
            "node": "AI Agent2",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "update_User1": {
      "ai_tool": [
        [
          {
            "node": "AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "update_User": {
      "ai_tool": [
        [
          {
            "node": "AI Agent1",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "get_User": {
      "ai_tool": [
        [
          {
            "node": "AI Agent",
            "type": "ai_tool",
            "index": 0
          },
          {
            "node": "AI Agent2",
            "type": "ai_tool",
            "index": 0
          },
          {
            "node": "AI Agent1",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "If7": {
      "main": [
        [
          {
            "node": "AI Agent2",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "AI Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "cerebro_vendedor": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent2",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": false,
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "",
  "meta": {
    "instanceId": "9aa3672f1fa9d73c90fc2de834ace9070f15041e1e5448af8f21f2e51ea63c7c"
  },
  "tags": []
}